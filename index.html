<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Groverâ€™s 2D Tech Adventure</title>
    <meta name="description" content="Explore Ronnie Groverâ€™s interactive, PokÃ©mon-style portfolio built with Kaboom.js." />
  </head>
  <body>
    <!-- Global styles (inline for simplicity) -->
    <style>
      @font-face {
        font-family: rubik;
        src: url(rubik.ttf);
        font-display: swap;
      }

      :root {
        --note-bg: rgba(0,0,0,0.6);
        --note-text: #f0f0f0;
        --note-accent: #ffcc00;
      }

      html, body {
        height: 100%;
      }

      body {
        margin: 0;
        font-family: rubik, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", sans-serif;
        font-size: 2rem;
        overflow: hidden; /* keep the canvas snug */
        background: #0f0f12; /* nice fallback behind canvas */
        color: #111;
      }

      #app {
        width: 100%;
        height: 100%;
        position: relative;
        isolation: isolate; /* keep z-index layers clean */
      }

      /* Dialogue/textbox */
      #textbox {
        position: absolute;
        left: 10%;
        right: 10%;
        bottom: 2vh;
        min-height: 10vh;
        background: whitesmoke;
        border-radius: 8px;
        outline: 2px solid #111;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        justify-content: flex-start;
        align-items: flex-start;
        word-spacing: 0.2rem;
        box-shadow: 0 0 0.69rem rgba(112, 112, 112, 0.6);
        z-index: 5;
      }

      .ui-text {
        margin: 0;
        user-select: none;
        font-size: 1rem;
        color: #111;
      }

      .ui-close-button,
      .ui-close-btn {
        font-family: rubik, sans-serif;
        border: none;
        border-radius: 6px;
        padding: 0.6rem 1rem;
        font-size: 1rem;
        background: #111;
        color: #fff;
        cursor: pointer;
      }

      .btn-container {
        align-self: flex-end;
        margin-top: 1rem;
      }

      /* NOTE: Floating tutorial box */
      .note {
        position: absolute;
        left: 5%;
        top: 2vh;
        max-width: 86%;
        padding: 0.75rem 1rem;
        background: var(--note-bg);
        border-radius: 10px;
        color: var(--note-text);
        line-height: 1.6;
        z-index: 10;             /* above the canvas */
        pointer-events: none;    /* clicks pass through to canvas */
        box-shadow: 0 0 0.5rem rgba(0,0,0,0.5);
        font-size: 1.1rem;
      }

      .note ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .note li {
        margin: 0.25rem 0;
        display: flex;
        align-items: flex-start;
        opacity: 0;             /* hidden until revealed by typewriter */
        transform: translateY(4px);
      }

      .note li::before {
        content: "â–¶";
        margin-right: 0.5rem;
        color: var(--note-accent);
        flex: 0 0 auto;
        line-height: 1.1;
        margin-top: 0.1rem;
      }

      /* Reveal animation */
      @keyframes revealLine {
        from { opacity: 0; transform: translateY(4px); }
        to   { opacity: 1; transform: translateY(0); }
      }

      /* Reduced motion: show all lines immediately */
      @media (prefers-reduced-motion: reduce) {
        .note li {
          opacity: 1 !important;
          transform: none !important;
          animation: none !important;
        }
      }

      /* Canvas */
      #game {
        position: relative;
        z-index: 0;
        display: block;
      }

      /* Small screens: tighten the note */
      @media (max-width: 640px) {
        .note {
          left: 4%;
          top: 1.5vh;
          max-width: 92%;
          font-size: 1rem;
          padding: 0.6rem 0.8rem;
        }
      }
    </style>

    <div id="app" role="application" aria-label="Groverâ€™s interactive portfolio">
      <!-- Friendly tutorial note -->
      <div class="note" aria-live="polite">
        <ul id="note-list">
          <li>ðŸ‘‹ Good morning, Ivy Brook Academy! Tap or click the screen to walk.</li>
          <li>âœ¨ Try the computer, bookshelf, TV, and more â€” they tell stories!</li>
          <li>ðŸ™‚ Have fun on the adventure!</li>
        </ul>
      </div>

      <!-- Game dialogue UI (hidden by default; shown by your game code) -->
      <div id="textbox-container" style="display:none">
        <div id="textbox" aria-live="polite">
          <p id="dialogue" class="ui-text"></p>
          <div class="btn-container">
            <button id="close" class="ui-close-button" aria-label="Close dialogue">Close</button>
          </div>
        </div>
      </div>

      <!-- Kaboom canvas -->
      <canvas id="game"></canvas>
    </div>

    <!-- Typewriter reveal for the note lines -->
    <script>
      (function () {
        const list = document.getElementById('note-list');
        if (!list) return;

        const lines = Array.from(list.querySelectorAll('li'));
        const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        if (prefersReduced) {
          // Show all immediately
          lines.forEach(li => {
            li.style.opacity = '1';
            li.style.transform = 'none';
          });
          return;
        }

        // Reveal each line in sequence
        const baseDelay = 200;   // initial pause before first line
        const stepDelay = 900;   // delay between lines
        lines.forEach((li, i) => {
          const delay = baseDelay + i * stepDelay;
          li.style.animation = `revealLine 320ms ease-out ${delay}ms forwards`;
        });

        // Optional: hide the note after some time (uncomment if desired)
        // setTimeout(() => {
        //   const note = document.querySelector('.note');
        //   if (note) note.style.display = 'none';
        // }, 12000);
      })();
    </script>

    <!-- Your game code -->
    <script type="module" src="src/main.js"></script>
  </body>
</html>
